"use strict";var mongoose=require("mongoose");mongoose.Promise=global.Promise;var slug=require("slugs"),storeSchema=new mongoose.Schema({name:{type:String,trim:!0,required:"Please enter a store name!"},slug:String,description:{type:String,trim:!0},tags:[String],created:{type:Date,default:Date.now},location:{type:{type:String,default:"Point"},coordinates:[{type:Number,required:"You must supply coordinates!"}],address:{type:String,required:"You must suppy an address!"}},photo:String});storeSchema.pre("save",function(t){var r,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isModified("name")){e.next=2;break}return e.abrupt("return",t());case 2:return this.slug=slug(this.name),r=new RegExp("^(".concat(this.slug,")((-[0-9]*$)?)$"),"i"),e.next=6,regeneratorRuntime.awrap(this.constructor.find({slug:r}));case 6:return(s=e.sent).length&&(this.slug="".concat(this.slug,"-").concat(s.length+1)),e.abrupt("return",t());case 9:case"end":return e.stop()}},null,this)}),module.exports=mongoose.model("Store",storeSchema);